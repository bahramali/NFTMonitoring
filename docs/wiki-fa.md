# رابط کاربری مانیتورینگ NFT

این صفحهٔ ویکی خلاصه‌ای از کارهایی که فرانت‌اند HydroLeaf Shop انجام می‌دهد و نحوهٔ تعامل آن با سرویس‌های بک‌اند را ارائه می‌کند.

## هدف
این برنامه داشبوردها و صفحات مشتری را برای مدیریت دستگاه‌های آبیاری مبتنی بر NFT فراهم می‌کند. فرانت‌اند برای احراز هویت، مدیریت کاربر و دریافت تلمتری زنده به APIهای بک‌اند متصل می‌شود تا کاربران بتوانند تجهیزات را پایش کنند و کارهای مبتنی بر نقش را انجام دهند.

## ویژگی‌های کلیدی
- **احراز هویت و مدیریت نشست**: کاربران با ایمیل و رمز عبور وارد می‌شوند. فرانت‌اند فقط فیلدهای دریافتی از بک‌اند (token، userId، role و permissions) را ذخیره می‌کند و بر اساس نقش مسیر دهی می‌کند.
- **ناوبری مبتنی بر نقش**: کاربران SUPER_ADMIN، ADMIN، WORKER و CUSTOMER بخش‌های متفاوتی می‌بینند. دسترسی ادمین بر اساس آرایهٔ permissions بازگشتی از بک‌اند کنترل می‌شود. SUPER_ADMIN دسترسی کامل دارد و می‌تواند داشبوردهای پایش را نیز مشاهده کند.
- **داشبوردهای پایش**: ادمین‌ها و کارکنان می‌توانند داشبوردهای سلامت دستگاه، عملکرد آبیاری و هشدارها را باز کنند.
- **صفحات کاربری**: مشتریان یک صفحهٔ اختصاصی «My Page» دارند تا دستگاه‌ها و اطلاعات حساب خود را ببینند.
- **دعوت ادمین‌ها**: صفحات مدیریت ادمین (فقط در دسترس SUPER_ADMIN) اجازه می‌دهد کاربران ADMIN با ایمیل دعوت و مدیریت شوند و سطح دسترسی آن‌ها تنظیم شود؛ هیچ نقش دیگری نمی‌تواند ادمین را دعوت یا ایجاد کند. ارسال ایمیل برای تنظیم رمز بر عهدهٔ بک‌اند است.

## نحوهٔ کار با بک‌اند
1. **ورود**: فرانت‌اند ایمیل/رمز عبور را به `/api/auth/login` می‌فرستد و token، userId، role و permissions بازگشتی را به عنوان تنها منبع حقیقت استفاده می‌کند.
2. **سطوح دسترسی**: برای کاربران ADMIN، آرایهٔ `permissions` تعیین می‌کند کدام صفحات و اقدام‌های ادمین نمایش داده شوند؛ سایر نقش‌ها این فیلد را نادیده می‌گیرند.
3. **کنترل دسترسی**: مسیرها و لینک‌های ناوبری نقش ذخیره‌شده و برای صفحات ادمین، دسترسی‌های لازم را بررسی می‌کنند. هیچ کاربری به صورت سخت‌کد شده امتیاز ویژه ندارد و SUPER_ADMIN همانند سایر نقش‌ها فقط با پاسخ بک‌اند تعیین می‌شود.
4. **خروج**: پاک کردن وضعیت نشست، token، userId، role و permissions را از حافظه و LocalStorage حذف می‌کند.

## انتظارات امنیتی
- هیچ اطلاعات ورود یا نقش از پیش تعریف‌شده‌ای در فرانت‌اند وجود ندارد.
- مقادیر حساس فقط برای نشست فعال نگه داشته می‌شوند و در خروج پاک می‌شوند.
- ارتقا یا تشخیص نقش کاملاً توسط پاسخ‌های بک‌اند تعیین می‌شود.

## مسیرهای کاربری
- **Customer**: ثبت‌نام یا ورود می‌کند و به `/my-page` برای داده‌های شخصی هدایت می‌شود.
- **Worker**: وارد می‌شود و به `/worker/dashboard` برای ابزارهای عملیاتی می‌رود.
- **Admin**: وارد می‌شود و فقط بخش‌های ادمین متناسب با permissions خود را می‌بیند؛ ادمین‌ها نمی‌توانند ادمین دیگری را دعوت یا ایجاد کنند.
- **Super Admin**: وارد می‌شود و به `/super-admin` و ابزارهای نظارتی مرتبط دسترسی دارد بدون آن‌که هیچ اعتبار از پیش تعیین‌شده‌ای در فرانت‌اند وجود داشته باشد. SUPER_ADMIN دسترسی کامل دارد و می‌تواند داشبوردهای پایش را نیز مشاهده کند. حساب‌های SUPER_ADMIN از طریق سید/مهاجرت اولیه یا فرآیند داخلی سمت سرور تهیه می‌شوند و از طریق UI یا API عمومی ایجاد نمی‌شوند.
