# تصویر کلی (Big Picture)

این سند نگاه لایه‌بالا از کل زنجیرهٔ استریمینگ را می‌دهد: از دوربین تا کاربر نهایی. هدف این است که اگر بعداً یکی از اجزا تغییر کرد، بقیهٔ سیستم با کمترین اصطکاک به‌روز شود.

## اجزای اصلی

- **منبع ویدیویی (Camera/Encoder)**: تولید RTSP/RTMP.
- **MediaMTX**: دریافت RTSP و تولید HLS.
- **Caddy**: انتشار امن (TLS)، روتینگ، و در صورت نیاز reverse proxy.
- **Cloudflare**: لایهٔ DNS/Proxy و محافظت.
- **Frontend**: مصرف HLS و پخش در مرورگر.

## جریان داده

1. دوربین استریم RTSP را به MediaMTX می‌دهد.
2. MediaMTX برای هر دوربین یک مسیر HLS می‌سازد.
3. Caddy مسیر HLS را با TLS در معرض اینترنت قرار می‌دهد.
4. Cloudflare (در صورت فعال بودن Proxy) ترافیک را عبور می‌دهد.
5. Frontend فایل `index.m3u8` را می‌گیرد و قطعات `.ts` را پشت سر هم پخش می‌کند.

## چرا این معماری؟

- **ماژولار**: هر بخش قابل تعویض است (مثلاً Caddy با Nginx).
- **پایدار و قابل توسعه**: افزودن دوربین جدید فقط اضافه شدن یک مسیر در MediaMTX است.
- **قابل نگهداری**: هر مرحله خطایابی مستقل دارد.

## خروجی‌های مورد انتظار

- URL نهایی HLS برای هر دوربین.
- TLS معتبر (گواهی سالم).
- زمان تأخیر قابل قبول (Latency) بسته به تنظیمات HLS.

> برای دیدن جریان درخواست و معماری، به پوشهٔ `docs/streaming/diagrams/` مراجعه کنید.
